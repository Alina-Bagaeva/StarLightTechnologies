# –û–ø–∏—Å–∞–Ω–∏–µ SQL –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏ –ø–æ –æ—Å—Ç–∞—Ç–∫–∞–º –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤

## üéØ **–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å –∑–∞–ø—Ä–æ—Å–∞**
–°–æ–∑–¥–∞–Ω–∏–µ **–µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –ø–æ –æ—Å—Ç–∞—Ç–∫–∞–º –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤** –Ω–∞ —Ä–∞—Å—á–µ—Ç–Ω—ã—Ö —Å—á–µ—Ç–∞—Ö –∏ –¥–µ–ø–æ–∑–∏—Ç–∞—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π –∑–∞ –ø–µ—Ä–∏–æ–¥ —Å 1 —è–Ω–≤–∞—Ä—è 2025 –≥–æ–¥–∞ –ø–æ —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É.

## üìä **–û–±—â–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã**

–ó–∞–ø—Ä–æ—Å –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç—Ä–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:
1. **–û—Å—Ç–∞—Ç–∫–∏ –Ω–∞ —Ä–∞—Å—á–µ—Ç–Ω—ã—Ö —Å—á–µ—Ç–∞—Ö** (—Ç–∞–±–ª–∏—Ü–∞ `OstatkiDeneg`)
2. **–û—Å—Ç–∞—Ç–∫–∏ –Ω–∞ –¥–µ–ø–æ–∑–∏—Ç–∞—Ö** (—Ç–∞–±–ª–∏—Ü–∞ `OstatkiDeneg2`)
3. **–î–≤–∏–∂–µ–Ω–∏–µ –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤** (—Ç–∞–±–ª–∏—Ü–∞ `DvizhenieDS`)

## üîß **–ü–æ—à–∞–≥–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –∫–æ–¥–∞**

### **1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è –¥–∞—Ç**
```sql
calendar AS (...)
```
- –°–æ–∑–¥–∞–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –¥–∞—Ç –æ—Ç `2025-01-01` –¥–æ **—Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–≥–æ –¥–Ω—è –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä—è–¥–∞

### **2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π (–¥–µ–ø–æ–∑–∏—Ç—ã)**
```sql
dim AS (...)
```
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏: **–ë–î + –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è + –†–∞—Å—á–µ—Ç–Ω—ã–π —Å—á–µ—Ç** –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –¥–µ–ø–æ–∑–∏—Ç–æ–≤
- –ï—Å–ª–∏ —Å—á–µ—Ç `NULL` ‚Üí –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `'Depozit'`

### **3. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π (—Ä–∞—Å—á–µ—Ç–Ω—ã–µ —Å—á–µ—Ç–∞)**
```sql
dim2 AS (...)
```
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –Ω–æ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã —Ä–∞—Å—á–µ—Ç–Ω—ã—Ö —Å—á–µ—Ç–æ–≤
- –•—Ä–∞–Ω–∏—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–æ–º–µ—Ä–∞ —Å—á–µ—Ç–æ–≤ (–±–µ–∑ –∑–∞–º–µ–Ω—ã –Ω–∞ `'Depozit'`)

### **4. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω—ã—Ö —Å–µ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö**
```sql
full_grid AS (...)
full_grid2 AS (...)
```
- –°–æ–∑–¥–∞–µ—Ç **–î–µ–∫–∞—Ä—Ç–æ–≤–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ**: –∫–∞–∂–¥–∞—è —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è √ó –∫–∞–∂–¥–∞—è –¥–∞—Ç–∞ –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∑–∞–ø–∏—Å–∏ **–¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è** –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏

### **5. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø—Ä–æ–ø—É—Å–∫–æ–≤**
```sql
result AS (...)
```
**–î–ª—è –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã –æ—Ç–¥–µ–ª—å–Ω–æ:**
- –°–æ–µ–¥–∏–Ω—è–µ—Ç –ø–æ–ª–Ω—É—é —Å–µ—Ç–∫—É —Å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏ –ø–æ –¥–∞—Ç–∞–º
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **–æ–∫–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `last_value()`** –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤:
  - –ï—Å–ª–∏ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –¥–∞—Ç—É –Ω–µ—Ç –æ—Å—Ç–∞—Ç–∫–∞ ‚Üí –±–µ—Ä–µ—Ç—Å—è **–ø–æ—Å–ª–µ–¥–Ω–µ–µ –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**
  - –ï—Å–ª–∏ –≤–æ–æ–±—â–µ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö ‚Üí —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è `0`
- –û–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–≤—É—Ö —Ç–∞–±–ª–∏—Ü —á–µ—Ä–µ–∑ `UNION ALL`

### **6. –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤**
```sql
postuplenia_viplaty AS (...)
```
- –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–≤–∏–∂–µ–Ω–∏—è –¥–µ–Ω–µ–≥ –ø–æ **–¥–∞—Ç–µ, –ë–î, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏ —Å—á–µ—Ç—É**
- –†–∞–∑–¥–µ–ª—è–µ—Ç —Å—É–º–º—ã –Ω–∞:
  - **–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è** (`EtoPostuplenie = true`)
  - **–í—ã–ø–ª–∞—Ç—ã** (`EtoPostuplenie = false`)
- NULL —Å—á–µ—Ç–∞ —Ç–∞–∫–∂–µ –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ `'Depozit'`

### **7. –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç**
```sql
SELECT ... FROM result r LEFT JOIN postuplenia_viplaty p ...
```
**–§–æ—Ä–º–∏—Ä—É–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:**

| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `date_col` | –î–∞—Ç–∞ –æ—Ç—á–µ—Ç–∞ |
| `BD` | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö |
| `Organizatsiya` | –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è |
| `RaschetniiSchet` | –†–∞—Å—á–µ—Ç–Ω—ã–π —Å—á–µ—Ç –∏–ª–∏ 'Depozit' |
| `SummaOstatok_Prev` | **–û—Å—Ç–∞—Ç–æ–∫ –Ω–∞ –∫–æ–Ω–µ—Ü –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –¥–Ω—è** (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç `lagInFrame()`) |
| `Postuplenie` | –°—É–º–º–∞ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–π –∑–∞ –¥–µ–Ω—å |
| `Viplata` | –°—É–º–º–∞ –≤—ã–ø–ª–∞—Ç –∑–∞ –¥–µ–Ω—å |
| `SummaOstatok` | **–û—Å—Ç–∞—Ç–æ–∫ –Ω–∞ –∫–æ–Ω–µ—Ü —Ç–µ–∫—É—â–µ–≥–æ –¥–Ω—è** |

## üîÑ **–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞**

### **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö**
- **Forward fill**: –µ—Å–ª–∏ –Ω–∞ –¥–∞—Ç—É –Ω–µ—Ç –æ—Å—Ç–∞—Ç–∫–∞ ‚Üí –±–µ—Ä–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- **Zero fill**: –µ—Å–ª–∏ –≤–æ–æ–±—â–µ –Ω–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ ‚Üí –æ—Å—Ç–∞—Ç–æ–∫ = 0

### **–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑–Ω–æ—Ä–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
1. **–î–µ–ø–æ–∑–∏—Ç—ã** (—Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ NULL —Å—á–µ—Ç–æ–≤)
2. **–†–∞—Å—á–µ—Ç–Ω—ã–µ —Å—á–µ—Ç–∞** (—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–æ–º–µ—Ä–∞)
3. **–û–ø–µ—Ä–∞—Ü–∏–∏ –¥–≤–∏–∂–µ–Ω–∏—è** (–ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è/–≤—ã–ø–ª–∞—Ç—ã)

### **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
–§–æ—Ä–º—É–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:
```
–û—Å—Ç–∞—Ç–æ–∫_—Å–µ–≥–æ–¥–Ω—è ‚âà –û—Å—Ç–∞—Ç–æ–∫_–≤—á–µ—Ä–∞ + –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è - –í—ã–ø–ª–∞—Ç—ã
```

## üìà **–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å –æ—Ç—á–µ—Ç–∞**

### **–î–ª—è –∞–Ω–∞–ª–∏–∑–∞:**
- **–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø–æ –≤—Å–µ–º —Å—á–µ—Ç–∞–º
- **–ê–Ω–∞–ª–∏–∑ –¥–µ–Ω–µ–∂–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤** (–ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è vs –≤—ã–ø–ª–∞—Ç—ã)
- **–í—ã—è–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π** –º–µ–∂–¥—É —É—á–µ—Ç–Ω—ã–º–∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏ –∏ –¥–≤–∏–∂–µ–Ω–∏–µ–º —Å—Ä–µ–¥—Å—Ç–≤

### **–î–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è:**
- **–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥** –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤
- **–°–≤–æ–¥–∫–∞ –ø–æ –≤—Å–µ–º –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º** –∏ —Å—á–µ—Ç–∞–º
- **–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** —Å —è–Ω–≤–∞—Ä—è 2025 –≥–æ–¥–∞

## ‚ö†Ô∏è **–í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è**

### **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö:**
- –î–ª—è –¥–µ–ø–æ–∑–∏—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—â–µ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ `'Depozit'`
- –†–∞—Å—á–µ—Ç–Ω—ã–µ —Å—á–µ—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ –Ω–æ–º–µ—Ä–∞–º–∏
- –î–≤–∏–∂–µ–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —Å—á–µ—Ç–∞–º

### **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ù–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –∫–∞–∫ `2025-01-01`
- –¢–æ–ª—å–∫–æ –¥–≤–∞ —Ç–∏–ø–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –æ—Å—Ç–∞—Ç–∫–æ–≤ (—Ä/—Å –∏ –¥–µ–ø–æ–∑–∏—Ç—ã)
- –ù–µ—Ç —É—á–µ—Ç–∞ –≤–∞–ª—é—Ç–Ω—ã—Ö –ø–µ—Ä–µ–æ—Ü–µ–Ω–æ–∫ –∏ –∫—É—Ä—Å–æ–≤—ã—Ö —Ä–∞–∑–Ω–∏—Ü

## üé® **–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**

| –î–∞—Ç–∞ | –ë–î | –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è | –°—á–µ—Ç | –í—á–µ—Ä–∞—à–Ω–∏–π –æ—Å—Ç–∞—Ç–æ–∫ | –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è | –í—ã–ø–ª–∞—Ç—ã | –°–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –æ—Å—Ç–∞—Ç–æ–∫ |
|------|----|-------------|------|-------------------|-------------|---------|---------------------|
| 2025-02-15 | DB1 | –û–û–û "–†–æ–º–∞—à–∫–∞" | 40702810... | 1,000,000.00 | 500,000.00 | 200,000.00 | 1,300,000.00 |
| 2025-02-15 | DB1 | –û–û–û "–†–æ–º–∞—à–∫–∞" | Depozit | 5,000,000.00 | 0.00 | 0.00 | 5,000,000.00 |

–≠—Ç–æ—Ç –æ—Ç—á–µ—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç **–µ–∂–µ–¥–Ω–µ–≤–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π –ø–æ –≤—Å–µ–º —Å—á–µ—Ç–∞–º —Å —É—á–µ—Ç–æ–º –¥–≤–∏–∂–µ–Ω–∏—è –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤.
