# –û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –ø–æ –æ—Å—Ç–∞—Ç–∫–∞–º –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Å—Ç–∞—Ç–µ–π –î–î–°

## üìä **1. –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –æ—Å—Ç–∞—Ç–∫–∞–º –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤**

### üéØ **–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å –∑–∞–ø—Ä–æ—Å–∞**
–°–æ–∑–¥–∞–Ω–∏–µ **–µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –ø–æ –æ—Å—Ç–∞—Ç–∫–∞–º –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤** –Ω–∞ —Ä–∞—Å—á–µ—Ç–Ω—ã—Ö —Å—á–µ—Ç–∞—Ö –∏ –¥–µ–ø–æ–∑–∏—Ç–∞—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π –∑–∞ –ø–µ—Ä–∏–æ–¥ —Å 1 —è–Ω–≤–∞—Ä—è 2025 –≥–æ–¥–∞ –ø–æ —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É.

### üìã **–û–±—â–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã**
–ó–∞–ø—Ä–æ—Å –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç—Ä–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:
1. **–û—Å—Ç–∞—Ç–∫–∏ –Ω–∞ —Ä–∞—Å—á–µ—Ç–Ω—ã—Ö —Å—á–µ—Ç–∞—Ö** (—Ç–∞–±–ª–∏—Ü–∞ `OstatkiDeneg`)
2. **–û—Å—Ç–∞—Ç–∫–∏ –Ω–∞ –¥–µ–ø–æ–∑–∏—Ç–∞—Ö** (—Ç–∞–±–ª–∏—Ü–∞ `OstatkiDeneg2`)
3. **–î–≤–∏–∂–µ–Ω–∏–µ –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤** (—Ç–∞–±–ª–∏—Ü–∞ `DvizhenieDS`)

### üîß **–ü–æ—à–∞–≥–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –∫–æ–¥–∞**

#### **1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è –¥–∞—Ç**
```sql
calendar AS (...)
```
- –°–æ–∑–¥–∞–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –¥–∞—Ç –æ—Ç `2025-01-01` –¥–æ **—Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–≥–æ –¥–Ω—è –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä—è–¥–∞

#### **2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π (–¥–µ–ø–æ–∑–∏—Ç—ã)**
```sql
dim AS (...)
```
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏: **–ë–î + –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è + –†–∞—Å—á–µ—Ç–Ω—ã–π —Å—á–µ—Ç** –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –¥–µ–ø–æ–∑–∏—Ç–æ–≤
- –ï—Å–ª–∏ —Å—á–µ—Ç `NULL` ‚Üí –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `'Depozit'`

#### **3. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π (—Ä–∞—Å—á–µ—Ç–Ω—ã–µ —Å—á–µ—Ç–∞)**
```sql
dim2 AS (...)
```
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –Ω–æ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã —Ä–∞—Å—á–µ—Ç–Ω—ã—Ö —Å—á–µ—Ç–æ–≤
- –•—Ä–∞–Ω–∏—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–æ–º–µ—Ä–∞ —Å—á–µ—Ç–æ–≤ (–±–µ–∑ –∑–∞–º–µ–Ω—ã –Ω–∞ `'Depozit'`)

#### **4. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω—ã—Ö —Å–µ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö**
```sql
full_grid AS (...)
full_grid2 AS (...)
```
- –°–æ–∑–¥–∞–µ—Ç **–î–µ–∫–∞—Ä—Ç–æ–≤–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ**: –∫–∞–∂–¥–∞—è —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è √ó –∫–∞–∂–¥–∞—è –¥–∞—Ç–∞ –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∑–∞–ø–∏—Å–∏ **–¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è** –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏

#### **5. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø—Ä–æ–ø—É—Å–∫–æ–≤**
```sql
result AS (...)
```
**–î–ª—è –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã –æ—Ç–¥–µ–ª—å–Ω–æ:**
- –°–æ–µ–¥–∏–Ω—è–µ—Ç –ø–æ–ª–Ω—É—é —Å–µ—Ç–∫—É —Å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏ –ø–æ –¥–∞—Ç–∞–º
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **–æ–∫–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `last_value()`** –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤:
  - –ï—Å–ª–∏ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –¥–∞—Ç—É –Ω–µ—Ç –æ—Å—Ç–∞—Ç–∫–∞ ‚Üí –±–µ—Ä–µ—Ç—Å—è **–ø–æ—Å–ª–µ–¥–Ω–µ–µ –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ**
  - –ï—Å–ª–∏ –≤–æ–æ–±—â–µ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö ‚Üí —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è `0`
- –û–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–≤—É—Ö —Ç–∞–±–ª–∏—Ü —á–µ—Ä–µ–∑ `UNION ALL`

#### **6. –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤**
```sql
postuplenia_viplaty AS (...)
```
- –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–≤–∏–∂–µ–Ω–∏—è –¥–µ–Ω–µ–≥ –ø–æ **–¥–∞—Ç–µ, –ë–î, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏ —Å—á–µ—Ç—É**
- –†–∞–∑–¥–µ–ª—è–µ—Ç —Å—É–º–º—ã –Ω–∞:
  - **–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è** (`EtoPostuplenie = true`)
  - **–í—ã–ø–ª–∞—Ç—ã** (`EtoPostuplenie = false`)
- NULL —Å—á–µ—Ç–∞ —Ç–∞–∫–∂–µ –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ `'Depozit'`

#### **7. –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç**
```sql
SELECT ... FROM result r LEFT JOIN postuplenia_viplaty p ...
```
**–§–æ—Ä–º–∏—Ä—É–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:**

| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `date_col` | –î–∞—Ç–∞ –æ—Ç—á–µ—Ç–∞ |
| `BD` | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö |
| `Organizatsiya` | –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è |
| `RaschetniiSchet` | –†–∞—Å—á–µ—Ç–Ω—ã–π —Å—á–µ—Ç –∏–ª–∏ 'Depozit' |
| `SummaOstatok_Prev` | **–û—Å—Ç–∞—Ç–æ–∫ –Ω–∞ –∫–æ–Ω–µ—Ü –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –¥–Ω—è** (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç `lagInFrame()`) |
| `Postuplenie` | –°—É–º–º–∞ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–π –∑–∞ –¥–µ–Ω—å |
| `Viplata` | –°—É–º–º–∞ –≤—ã–ø–ª–∞—Ç –∑–∞ –¥–µ–Ω—å |
| `SummaOstatok` | **–û—Å—Ç–∞—Ç–æ–∫ –Ω–∞ –∫–æ–Ω–µ—Ü —Ç–µ–∫—É—â–µ–≥–æ –¥–Ω—è** |

### üîÑ **–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞**

#### **–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö**
- **Forward fill**: –µ—Å–ª–∏ –Ω–∞ –¥–∞—Ç—É –Ω–µ—Ç –æ—Å—Ç–∞—Ç–∫–∞ ‚Üí –±–µ—Ä–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- **Zero fill**: –µ—Å–ª–∏ –≤–æ–æ–±—â–µ –Ω–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ ‚Üí –æ—Å—Ç–∞—Ç–æ–∫ = 0

#### **–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑–Ω–æ—Ä–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
1. **–î–µ–ø–æ–∑–∏—Ç—ã** (—Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ NULL —Å—á–µ—Ç–æ–≤)
2. **–†–∞—Å—á–µ—Ç–Ω—ã–µ —Å—á–µ—Ç–∞** (—Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–æ–º–µ—Ä–∞)
3. **–û–ø–µ—Ä–∞—Ü–∏–∏ –¥–≤–∏–∂–µ–Ω–∏—è** (–ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è/–≤—ã–ø–ª–∞—Ç—ã)

#### **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
–§–æ—Ä–º—É–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:
```
–û—Å—Ç–∞—Ç–æ–∫_—Å–µ–≥–æ–¥–Ω—è ‚âà –û—Å—Ç–∞—Ç–æ–∫_–≤—á–µ—Ä–∞ + –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è - –í—ã–ø–ª–∞—Ç—ã
```

### üìà **–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å –æ—Ç—á–µ—Ç–∞**

#### **–î–ª—è –∞–Ω–∞–ª–∏–∑–∞:**
- **–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø–æ –≤—Å–µ–º —Å—á–µ—Ç–∞–º
- **–ê–Ω–∞–ª–∏–∑ –¥–µ–Ω–µ–∂–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤** (–ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è vs –≤—ã–ø–ª–∞—Ç—ã)
- **–í—ã—è–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π** –º–µ–∂–¥—É —É—á–µ—Ç–Ω—ã–º–∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏ –∏ –¥–≤–∏–∂–µ–Ω–∏–µ–º —Å—Ä–µ–¥—Å—Ç–≤

#### **–î–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è:**
- **–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥** –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤
- **–°–≤–æ–¥–∫–∞ –ø–æ –≤—Å–µ–º –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º** –∏ —Å—á–µ—Ç–∞–º
- **–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** —Å —è–Ω–≤–∞—Ä—è 2025 –≥–æ–¥–∞

### ‚ö†Ô∏è **–í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è**

#### **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö:**
- –î–ª—è –¥–µ–ø–æ–∑–∏—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—â–µ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ `'Depozit'`
- –†–∞—Å—á–µ—Ç–Ω—ã–µ —Å—á–µ—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ –Ω–æ–º–µ—Ä–∞–º–∏
- –î–≤–∏–∂–µ–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —Å—á–µ—Ç–∞–º

#### **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –ù–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –∫–∞–∫ `2025-01-01`
- –¢–æ–ª—å–∫–æ –¥–≤–∞ —Ç–∏–ø–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –æ—Å—Ç–∞—Ç–∫–æ–≤ (—Ä/—Å –∏ –¥–µ–ø–æ–∑–∏—Ç—ã)
- –ù–µ—Ç —É—á–µ—Ç–∞ –≤–∞–ª—é—Ç–Ω—ã—Ö –ø–µ—Ä–µ–æ—Ü–µ–Ω–æ–∫ –∏ –∫—É—Ä—Å–æ–≤—ã—Ö —Ä–∞–∑–Ω–∏—Ü

### üé® **–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**

| –î–∞—Ç–∞ | –ë–î | –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è | –°—á–µ—Ç | –í—á–µ—Ä–∞—à–Ω–∏–π –æ—Å—Ç–∞—Ç–æ–∫ | –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è | –í—ã–ø–ª–∞—Ç—ã | –°–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –æ—Å—Ç–∞—Ç–æ–∫ |
|------|----|-------------|------|-------------------|-------------|---------|---------------------|
| 2025-02-15 | DB1 | –û–û–û "–†–æ–º–∞—à–∫–∞" | 40702810... | 1,000,000.00 | 500,000.00 | 200,000.00 | 1,300,000.00 |
| 2025-02-15 | DB1 | –û–û–û "–†–æ–º–∞—à–∫–∞" | Depozit | 5,000,000.00 | 0.00 | 0.00 | 5,000,000.00 |

–≠—Ç–æ—Ç –æ—Ç—á–µ—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç **–µ–∂–µ–¥–Ω–µ–≤–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ** –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π –ø–æ –≤—Å–µ–º —Å—á–µ—Ç–∞–º —Å —É—á–µ—Ç–æ–º –¥–≤–∏–∂–µ–Ω–∏—è –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤.

---

## üèóÔ∏è **2. –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–µ–π –¥–≤–∏–∂–µ–Ω–∏—è –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤**

### üéØ **–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å –∑–∞–ø—Ä–æ—Å–∞**
–°–æ–∑–¥–∞–Ω–∏–µ **–∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å—Ç–∞—Ç–µ–π –î–î–°** –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤ —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ —É—Ä–æ–≤–Ω—è–º.

### üìã **–û–±—â–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã**
–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –ø–ª–æ—Å–∫—É—é —Ç–∞–±–ª–∏—Ü—É —Å—Ç–∞—Ç–µ–π –î–î–° –≤ **–¥—Ä–µ–≤–æ–≤–∏–¥–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É** —Å –¥–≤—É–º—è —É—Ä–æ–≤–Ω—è–º–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏:
1. **–ö–æ—Ä–Ω–µ–≤–∞—è –ø–∞–ø–∫–∞** (root_folder) - —Å–∞–º—ã–π –≤–µ—Ä—Ö–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å
2. **–ü–∞–ø–∫–∞** (folder) - –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
3. **–°—Ç–∞—Ç—å—è –î–î–°** (StatyaDDS) - –∫–æ–Ω–µ—á–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –∏–µ—Ä–∞—Ä—Ö–∏–∏

### üîß **–ü–æ—à–∞–≥–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –∫–æ–¥–∞**

#### **1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–µ—Ä–∞—Ä—Ö–∏–∏**
```sql
(
    select 
        sdds.Naimenovanie as root_folder,
        sdds.StatyaID as root_id,
        sdds1.Naimenovanie as folder_1,
        sdds1.StatyaID as folder_id
    from 
        `StatiDvizheniyaDenezhnykhSredstv` sdds
    left join 
        `StatiDvizheniyaDenezhnykhSredstv` sdds1 on 
        sdds1.GruppaStatiID = sdds.StatyaID and sdds1.EtoGruppa 
    where 
        sdds.GruppaStati is null and sdds.EtoGruppa 
) t
```
- –í—ã–±–∏—Ä–∞–µ—Ç **–∫–æ—Ä–Ω–µ–≤—ã–µ –≥—Ä—É–ø–ø—ã** (`GruppaStati is null` –∏ `EtoGruppa = true`)
- –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç **–ø–æ–¥–≥—Ä—É–ø–ø—ã –ø–µ—Ä–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è**, –∫–æ—Ç–æ—Ä—ã–µ —Å—Å—ã–ª–∞—é—Ç—Å—è –Ω–∞ —ç—Ç–∏ –∫–æ—Ä–Ω–µ–≤—ã–µ –≥—Ä—É–ø–ø—ã
- –§–æ—Ä–º–∏—Ä—É–µ—Ç —Ç–∞–±–ª–∏—Ü—É —Å–≤—è–∑–µ–π: **–∫–æ—Ä–Ω–µ–≤–∞—è –≥—Ä—É–ø–ø–∞ ‚Üí –ø–æ–¥–≥—Ä—É–ø–ø–∞**

#### **2. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –∏–µ—Ä–∞—Ä—Ö–∏–∏**
```sql
select 
    coalesce(t.root_folder, coalesce(t.folder_1, sdds.Naimenovanie)) as root_folder,
    coalesce(t.folder_1, sdds.Naimenovanie) as folder,
    sdds.Naimenovanie as StatyaDDS,
    sdds.StatyaID
```
- **root_folder**: –±–µ—Ä–µ—Ç—Å—è –∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –≥—Ä—É–ø–ø—ã, –µ—Å–ª–∏ –Ω–µ—Ç ‚Üí –∏–∑ –ø–æ–¥–≥—Ä—É–ø–ø—ã, –µ—Å–ª–∏ –Ω–µ—Ç ‚Üí –∏–∑ —Å–∞–º–æ–π —Å—Ç–∞—Ç—å–∏
- **folder**: –±–µ—Ä–µ—Ç—Å—è –∏–∑ –ø–æ–¥–≥—Ä—É–ø–ø—ã, –µ—Å–ª–∏ –Ω–µ—Ç ‚Üí –∏–∑ —Å–∞–º–æ–π —Å—Ç–∞—Ç—å–∏
- **StatyaDDS**: –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏
- **StatyaID**: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞—Ç—å–∏

#### **3. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω–µ—á–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤**
```sql
where 
    not sdds.EtoGruppa
```
- –í—ã–±–∏—Ä–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ **–∫–æ–Ω–µ—á–Ω—ã–µ —Å—Ç–∞—Ç—å–∏** (–Ω–µ –≥—Ä—É–ø–ø—ã)
- –ì—Ä—É–ø–ø—ã (`EtoGruppa = true`) —Å–ª—É–∂–∞—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### üå≤ **–ü—Ä–∏–º–µ—Ä –∏–µ—Ä–∞—Ä—Ö–∏–∏**

**–ò—Å—Ö–æ–¥–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- –î–µ–Ω–µ–∂–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –æ—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–∫–æ—Ä–µ–Ω—å)
  - –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –æ—Ç –ø—Ä–æ–¥–∞–∂–∏ —Ç–æ–≤–∞—Ä–æ–≤ (–ø–æ–¥–≥—Ä—É–ø–ø–∞)
    - –ü—Ä–æ–¥–∞–∂–∞ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –ê (—Å—Ç–∞—Ç—å—è)
    - –ü—Ä–æ–¥–∞–∂–∞ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –ë (—Å—Ç–∞—Ç—å—è)
  - –û–ø–ª–∞—Ç–∞ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º (–ø–æ–¥–≥—Ä—É–ø–ø–∞)
    - –°—ã—Ä—å–µ –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã (—Å—Ç–∞—Ç—å—è)
    - –£—Å–ª—É–≥–∏ (—Å—Ç–∞—Ç—å—è)

**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è:**

| root_folder | folder | StatyaDDS | StatyaID |
|-------------|--------|-----------|----------|
| –î–µ–Ω–µ–∂–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –æ—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ | –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –æ—Ç –ø—Ä–æ–¥–∞–∂–∏ —Ç–æ–≤–∞—Ä–æ–≤ | –ü—Ä–æ–¥–∞–∂–∞ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –ê | 101 |
| –î–µ–Ω–µ–∂–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –æ—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ | –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –æ—Ç –ø—Ä–æ–¥–∞–∂–∏ —Ç–æ–≤–∞—Ä–æ–≤ | –ü—Ä–æ–¥–∞–∂–∞ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –ë | 102 |
| –î–µ–Ω–µ–∂–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –æ—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ | –û–ø–ª–∞—Ç–∞ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º | –°—ã—Ä—å–µ –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã | 201 |
| –î–µ–Ω–µ–∂–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –æ—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ | –û–ø–ª–∞—Ç–∞ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞–º | –£—Å–ª—É–≥–∏ | 202 |

### üìà **–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è**

#### **–î–ª—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏:**
- **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å—Ç–∞—Ç–µ–π –î–î–°** –ø–æ –ª–æ–≥–∏—á–µ—Å–∫–∏–º —Ä–∞–∑–¥–µ–ª–∞–º
- **–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è** –æ—Ç –æ–±—â–µ–≥–æ –∫ —á–∞—Å—Ç–Ω–æ–º—É
- **–ï–¥–∏–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** –¥–ª—è –≤—Å–µ—Ö –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç—á–µ—Ç–æ–≤

#### **–î–ª—è –∞–Ω–∞–ª–∏–∑–∞:**
- **–ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–µ–Ω–µ–∂–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤** –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑** —Å—Ç–∞—Ç–µ–π –≤–Ω—É—Ç—Ä–∏ –≥—Ä—É–ø–ø
- **–ö–æ–Ω—Å–æ–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** –ø–æ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–º —É—Ä–æ–≤–Ω—è–º

### üîó **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Ç—á–µ—Ç–æ–º –ø–æ –æ—Å—Ç–∞—Ç–∫–∞–º**

–≠—Ç–∏ –¥–≤–∞ –æ–±—ä–µ–∫—Ç–∞ –≤–∑–∞–∏–º–æ–¥–æ–ø–æ–ª–Ω—è—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞:

1. **–û—Ç—á–µ—Ç –ø–æ –æ—Å—Ç–∞—Ç–∫–∞–º** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
   - –°–∫–æ–ª—å–∫–æ –¥–µ–Ω–µ–≥ –Ω–∞ —Å—á–µ—Ç–∞—Ö
   - –û—Ç–∫—É–¥–∞ –ø—Ä–∏—à–ª–∏ –∏ –∫—É–¥–∞ —É—à–ª–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞

2. **–ò–µ—Ä–∞—Ä—Ö–∏—è —Å—Ç–∞—Ç–µ–π –î–î–°** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
   - –ü–æ –∫–∞–∫–∏–º —Å—Ç–∞—Ç—å—è–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ –¥–≤–∏–∂–µ–Ω–∏–µ
   - –ö–∞–∫ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã —Å—Ç–∞—Ç—å–∏ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
   - –°—Ç—Ä—É–∫—Ç—É—Ä—É –¥–µ–Ω–µ–∂–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

### üéØ **–û–±—â–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å –¥–ª—è –±–∏–∑–Ω–µ—Å–∞**

**–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å:**
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—Å—Ç–∞—Ç–∫–æ–≤ –Ω–∞ —Å—á–µ—Ç–∞—Ö
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- –ö–æ–Ω—Ç—Ä–æ–ª—å –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

**–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑:**
- –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–µ–Ω–µ–∂–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤
- –í—ã—è–≤–ª–µ–Ω–∏–µ —Å–µ–∑–æ–Ω–Ω—ã—Ö –∏ —Ç—Ä–µ–Ω–¥–æ–≤—ã—Ö –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π
- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–Ω–µ–∂–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤

**–£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å:**
- –ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å—Ç–∞—Ç–µ–π –î–î–°
- –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º–∏ –æ—Ç—á–µ—Ç–∞–º–∏

---

## üõ†Ô∏è **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**

### **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–∫–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π —á–µ—Ä–µ–∑ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–≥—Ä–µ–≥–∞—Ü–∏—é
- –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

### **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:**
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π –∏ —Å—á–µ—Ç–æ–≤
- –ì–∏–±–∫–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è —Å—Ç–∞—Ç–µ–π –î–î–°
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞

### **–ü–æ–¥–¥–µ—Ä–∂–∫–∞:**
- –ß–µ—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

–û–±–∞ –∑–∞–ø—Ä–æ—Å–∞ –æ–±—Ä–∞–∑—É—é—Ç **–∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤**, –ø–æ–∑–≤–æ–ª—è—é—â—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å—é –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–µ–Ω–µ–∂–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏.