
# –û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –ø–æ –æ—Å—Ç–∞—Ç–∫–∞–º –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Å—Ç–∞—Ç–µ–π –î–î–°

## üìä **1. –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –æ—Å—Ç–∞—Ç–∫–∞–º –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ (Ostatki.sql)**

### üéØ **–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å –∑–∞–ø—Ä–æ—Å–∞**
–°–æ–∑–¥–∞–Ω–∏–µ **–µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –ø–æ –æ—Å—Ç–∞—Ç–∫–∞–º –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤** –Ω–∞ —Ä–∞—Å—á–µ—Ç–Ω—ã—Ö —Å—á–µ—Ç–∞—Ö –∏ –¥–µ–ø–æ–∑–∏—Ç–∞—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π –∑–∞ –ø–µ—Ä–∏–æ–¥ —Å 1 —è–Ω–≤–∞—Ä—è 2025 –≥–æ–¥–∞ –ø–æ —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É.

### üìã **–û–±—â–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã**
–ó–∞–ø—Ä–æ—Å –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –¥–≤—É—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:
1. **–û—Å—Ç–∞—Ç–∫–∏ –Ω–∞ —Ä–∞—Å—á–µ—Ç–Ω—ã—Ö —Å—á–µ—Ç–∞—Ö –∏ –¥–µ–ø–æ–∑–∏—Ç–∞—Ö** (—Ç–∞–±–ª–∏—Ü–∞ `OstatkiDeneg`)
2. **–î–≤–∏–∂–µ–Ω–∏–µ –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤** (—Ç–∞–±–ª–∏—Ü–∞ `DvizhenieDS`)

### üîß **–ü–æ—à–∞–≥–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –∫–æ–¥–∞**

#### **1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è –¥–∞—Ç**
```sql
calendar AS (...)
```
- –°–æ–∑–¥–∞–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –¥–∞—Ç –æ—Ç `2024-12-31` –¥–æ **—Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–≥–æ –¥–Ω—è –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ä—è–¥–∞

#### **2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π**
```sql
dim AS (...)
```
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏: **–ë–î + –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è + –†–∞—Å—á–µ—Ç–Ω—ã–π —Å—á–µ—Ç** –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –æ—Å—Ç–∞—Ç–∫–æ–≤
- –î–ª—è –¥–µ–ø–æ–∑–∏—Ç–æ–≤ (`EtoDepozit = true`) —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—á–µ—Ç–∞: `'55 —Å—á—ë—Ç ' + –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è`

#### **3. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–π —Å–µ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö**
```sql
full_grid AS (...)
```
- –°–æ–∑–¥–∞–µ—Ç **–î–µ–∫–∞—Ä—Ç–æ–≤–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ**: –∫–∞–∂–¥–∞—è —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è √ó –∫–∞–∂–¥–∞—è –¥–∞—Ç–∞ –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∑–∞–ø–∏—Å–∏ **–¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è** –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏

#### **4. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Å—Ç–∞—Ç–∫–æ–≤**
```sql
ostatki as (...)
```
- –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `OstatkiDeneg` –≤ —É–¥–æ–±–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
- –î–ª—è –¥–µ–ø–æ–∑–∏—Ç–æ–≤ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è —Ç–æ –∂–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—á–µ—Ç–∞, —á—Ç–æ –∏ –≤ `dim`

#### **5. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –ø—Ä–æ–ø—É—Å–∫–æ–≤**
```sql
result AS (...)
```
- –°–æ–µ–¥–∏–Ω—è–µ—Ç –ø–æ–ª–Ω—É—é —Å–µ—Ç–∫—É —Å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ –æ—Å—Ç–∞—Ç–∫–∞–º–∏ –ø–æ –¥–∞—Ç–∞–º
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **COALESCE** –¥–ª—è –∑–∞–º–µ–Ω—ã NULL –æ—Å—Ç–∞—Ç–∫–æ–≤ –Ω–∞ `0`
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –¥–∞—Ç–µ, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏ —Å—á–µ—Ç—É

#### **6. –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤**
```sql
postuplenia_viplaty AS (...)
```
- –ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–≤–∏–∂–µ–Ω–∏—è –¥–µ–Ω–µ–≥ –ø–æ **–¥–∞—Ç–µ, –ë–î, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏ —Å—á–µ—Ç—É**
- –†–∞–∑–¥–µ–ª—è–µ—Ç —Å—É–º–º—ã –Ω–∞:
  - **–ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è** (`EtoPostuplenie = true`)
  - **–í—ã–ø–ª–∞—Ç—ã** (`EtoPostuplenie = false`)
- –î–ª—è –¥–µ–ø–æ–∑–∏—Ç–æ–≤ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—á–µ—Ç–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–∏–º —à–∞–≥–∞–º

#### **7. –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç**
```sql
SELECT ... FROM result r LEFT JOIN postuplenia_viplaty p ...
```
**–§–æ—Ä–º–∏—Ä—É–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:**

| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `date` | –î–∞—Ç–∞ –æ—Ç—á–µ—Ç–∞ |
| `bd` | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö |
| `Organizatsiya` | –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è |
| `RaschetniiSchet` | –†–∞—Å—á–µ—Ç–Ω—ã–π —Å—á–µ—Ç –∏–ª–∏ '55 —Å—á—ë—Ç + –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è' –¥–ª—è –¥–µ–ø–æ–∑–∏—Ç–æ–≤ |
| `SummaOstatok_BEGIN` | **–û—Å—Ç–∞—Ç–æ–∫ –Ω–∞ –Ω–∞—á–∞–ª–æ –¥–Ω—è** (–¥–ª—è 2024-12-31 —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è 0) |
| `Postuplenie` | –°—É–º–º–∞ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–π –∑–∞ –¥–µ–Ω—å |
| `Viplata` | –°—É–º–º–∞ –≤—ã–ø–ª–∞—Ç –∑–∞ –¥–µ–Ω—å |
| `SummaOstatok_END` | **–û—Å—Ç–∞—Ç–æ–∫ –Ω–∞ –∫–æ–Ω–µ—Ü –¥–Ω—è** |

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞—Å—á–µ—Ç–∞:**
- –î–ª—è `2024-12-31`: `SummaOstatok_BEGIN = 0`, `SummaOstatok_END = Postuplenie`
- –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –¥–Ω–µ–π: `SummaOstatok_BEGIN = –í—á–µ—Ä–∞—à–Ω–∏–π –æ—Å—Ç–∞—Ç–æ–∫ - –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è + –í—ã–ø–ª–∞—Ç—ã`

### üìà **–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å –æ—Ç—á–µ—Ç–∞**
- **–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø–æ –≤—Å–µ–º —Å—á–µ—Ç–∞–º –∏ –¥–µ–ø–æ–∑–∏—Ç–∞–º
- **–ê–Ω–∞–ª–∏–∑ –¥–µ–Ω–µ–∂–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤** (–ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è vs –≤—ã–ø–ª–∞—Ç—ã)
- **–ö–æ–Ω—Ç—Ä–æ–ª—å –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏** –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π
- **–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥** –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –¥–∞—Ç

---

## üìà **2. –û—Ç—á–µ—Ç –ø–æ –æ—Å—Ç–∞—Ç–∫–∞–º —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –¥–Ω–µ–º (Ostatki_otchet.sql)**

### üéØ **–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å –∑–∞–ø—Ä–æ—Å–∞**
–°–æ–∑–¥–∞–Ω–∏–µ **—É–ø—Ä–æ—â–µ–Ω–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –ø–æ –æ—Å—Ç–∞—Ç–∫–∞–º** —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ–º –æ—Å—Ç–∞—Ç–∫–∞ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å –¥–ª—è –∫–∞–∂–¥–æ–π –ë–î.

### üìã **–û–±—â–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã**
–ë–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç—á–µ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞:
1. **–ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Å—Ç–∞—Ç–∫–∞—Ö –ø–æ –ë–î** (–±–µ–∑ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º –∏ —Å—á–µ—Ç–∞–º)
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–º —Ä–∞—Å—á–µ—Ç–µ** –æ—Å—Ç–∞—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –¥–Ω—è

### üîß **–ö–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è –æ—Ç Ostatki.sql**
- –ê–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –æ—Å—Ç–∞—Ç–∫–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ **–ë–î**, –∞ –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å—á–µ—Ç–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **–æ–∫–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é** `lagInFrame()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Å—Ç–∞—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –¥–Ω—è
- –ù–µ –≤–∫–ª—é—á–∞–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤ (–ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è/–≤—ã–ø–ª–∞—Ç—ã)
- –ë–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä—ã–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î

### üìä **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**

| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `date_col` | –î–∞—Ç–∞ –æ—Ç—á–µ—Ç–∞ |
| `BD` | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö |
| `ostatok` | –û—Å—Ç–∞—Ç–æ–∫ –Ω–∞ —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É |
| `ostatok_prev_day` | –û—Å—Ç–∞—Ç–æ–∫ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ–Ω—å |

### üéØ **–ë–∏–∑–Ω–µ—Å-–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**
- **–ë—ã—Å—Ç—Ä—ã–π –æ–±–∑–æ—Ä** –æ–±—â–µ–π –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ –ø–æ –±–∞–∑–∞–º –¥–∞–Ω–Ω—ã—Ö
- **–¢—Ä–µ–Ω–¥–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑** –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤
- **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ** –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –ë–î
- **–í–∞–ª–∏–¥–∞—Ü–∏—è** –¥–∞–Ω–Ω—ã—Ö –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞

---

## üèóÔ∏è **3. –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–µ–π –î–î–° (Table_hierarcy.sql)**

### üéØ **–û—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å –∑–∞–ø—Ä–æ—Å–∞**
–°–æ–∑–¥–∞–Ω–∏–µ **–∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å—Ç–∞—Ç–µ–π –î–î–°** –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –æ—Ç—á–µ—Ç–æ–≤ —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ —É—Ä–æ–≤–Ω—è–º.

### üìã **–û–±—â–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã**
–ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –ø–ª–æ—Å–∫—É—é —Ç–∞–±–ª–∏—Ü—É —Å—Ç–∞—Ç–µ–π –î–î–° –≤ **–¥—Ä–µ–≤–æ–≤–∏–¥–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É** —Å —Ç—Ä–µ–º—è —É—Ä–æ–≤–Ω—è–º–∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏:
1. **–ö–æ—Ä–Ω–µ–≤–∞—è –ø–∞–ø–∫–∞** (root_folder) - —Å–∞–º—ã–π –≤–µ—Ä—Ö–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å
2. **–ü–∞–ø–∫–∞** (folder) - –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å
3. **–ü–∞–ø–∫–∞1** (folder1) - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
4. **–°—Ç–∞—Ç—å—è –î–î–°** (StatyaDDS) - –∫–æ–Ω–µ—á–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –∏–µ—Ä–∞—Ä—Ö–∏–∏

### üîß **–ü–æ—à–∞–≥–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –∫–æ–¥–∞**

#### **1. –í—ã–¥–µ–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø —Å—Ç–∞—Ç–µ–π**
```sql
gruppa AS (...)
```
- –í—ã–±–∏—Ä–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –≥—Ä—É–ø–ø–∞–º–∏ (`EtoGruppa = true`)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç: –Ω–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã, ID –≥—Ä—É–ø–ø—ã –∏ ID —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –≥—Ä—É–ø–ø—ã

#### **2. –í—ã–¥–µ–ª–µ–Ω–∏–µ –∫–æ–Ω–µ—á–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π**
```sql
stati AS (...)
```
- –í—ã–±–∏—Ä–∞–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –∫–æ–Ω–µ—á–Ω—ã–º–∏ —Å—Ç–∞—Ç—å—è–º–∏ (`EtoGruppa = false`)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç: –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏, ID —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –≥—Ä—É–ø–ø—ã –∏ ID —Å—Ç–∞—Ç—å–∏

#### **3. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏**
```sql
SELECT ... FROM stati st LEFT JOIN gruppa g ... LEFT JOIN gruppa g1 ... LEFT JOIN gruppa g2 ...
```
- –°—Ç—Ä–æ–∏—Ç –∏–µ—Ä–∞—Ä—Ö–∏—é –¥–æ 3 —É—Ä–æ–≤–Ω–µ–π –≤ –≥–ª—É–±–∏–Ω—É
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **COALESCE** –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –∏–µ—Ä–∞—Ä—Ö–∏–∏
- –§–æ—Ä–º–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –æ—Ç –∫–æ—Ä–Ω–µ–≤–æ–π –≥—Ä—É–ø–ø—ã –¥–æ –∫–æ–Ω–µ—á–Ω–æ–π —Å—Ç–∞—Ç—å–∏

### üå≤ **–ü—Ä–∏–º–µ—Ä –∏–µ—Ä–∞—Ä—Ö–∏–∏**

**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è:**

| root_folder | folder | folder1 | StatyaDDS | StatyaID |
|-------------|--------|---------|-----------|----------|
| –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è | –û—Ç –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π | –ü—Ä–æ–¥–∞–∂–∞ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –ê | ... |
| –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –ü–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è | –û—Ç –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π | –ü—Ä–æ–¥–∞–∂–∞ –ø—Ä–æ–¥—É–∫—Ü–∏–∏ –ë | ... |
| –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –í—ã–ø–ª–∞—Ç—ã | –ü–æ—Å—Ç–∞–≤—â–∏–∫–∞–º | –°—ã—Ä—å–µ –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã | ... |
| –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –ü–æ–∫—É–ø–∫–∞ –û–° | –¢–µ—Ö–Ω–∏–∫–∞ | –ö–æ–º–ø—å—é—Ç–µ—Ä—ã | ... |

### üìà **–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è**
- **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Å—Ç–∞—Ç–µ–π –î–î–°** –ø–æ –ª–æ–≥–∏—á–µ—Å–∫–∏–º —Ä–∞–∑–¥–µ–ª–∞–º
- **–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è** –æ—Ç –æ–±—â–µ–≥–æ –∫ —á–∞—Å—Ç–Ω–æ–º—É
- **–ï–¥–∏–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** –¥–ª—è –≤—Å–µ—Ö –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç—á–µ—Ç–æ–≤
- **–£–ø—Ä–æ—â–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏** –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ –≥—Ä—É–ø–ø–∞–º

---

## üéØ **–û–±—â–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –±–∏–∑–Ω–µ—Å–∞**

### **–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å:**
- –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—Å—Ç–∞—Ç–∫–æ–≤ –Ω–∞ –≤—Å–µ—Ö —Å—á–µ—Ç–∞—Ö –∏ –¥–µ–ø–æ–∑–∏—Ç–∞—Ö
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- –ö–æ–Ω—Ç—Ä–æ–ª—å –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º –∏ –ë–î

### **–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑:**
- –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–µ–Ω–µ–∂–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ –ø–æ –∏–µ—Ä–∞—Ä—Ö–∏–∏ —Å—Ç–∞—Ç–µ–π
- –í—ã—è–≤–ª–µ–Ω–∏–µ —Å–µ–∑–æ–Ω–Ω—ã—Ö –∏ —Ç—Ä–µ–Ω–¥–æ–≤—ã—Ö –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–µ–π
- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–Ω–µ–∂–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### **–£–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å:**
- –ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å—Ç–∞—Ç–µ–π –î–î–°
- –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –æ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–æ —Å–≤–æ–¥–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –¥–≤–∏–∂–µ–Ω–∏–∏ –∏ –æ—Å—Ç–∞—Ç–∫–∞—Ö –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤

### **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å**: –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å —Ä–µ—à–∞–µ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∑–∞–¥–∞—á—É
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å –æ–∫–æ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞—Å—Ç—É—â–µ–≥–æ –æ–±—ä–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö
- **–ì–∏–±–∫–æ—Å—Ç—å**: –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–æ–¥ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏

---

## üîÑ **–í–∑–∞–∏–º–æ—Å–≤—è–∑—å –º–µ–∂–¥—É –æ—Ç—á–µ—Ç–∞–º–∏**

1. **Ostatki.sql** ‚Üí –î–µ—Ç–∞–ª—å–Ω—ã–π –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á–µ—Ç —Å –¥–≤–∏–∂–µ–Ω–∏–µ–º —Å—Ä–µ–¥—Å—Ç–≤
2. **Ostatki_otchet.sql** ‚Üí –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
3. **Table_hierarcy.sql** ‚Üí –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç–∞—Ç–µ–π –î–î–°

**–¢–∏–ø–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Table_hierarcy.sql** –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å—Ç–∞—Ç–µ–π –î–î–°
2. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ **Ostatki.sql**
3. –ü–æ–ª—É—á–∞–π—Ç–µ —Å–≤–æ–¥–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ **Ostatki_otchet.sql**

–≠—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç **–ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π –¥–µ–Ω–µ–∂–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤** –æ—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.
